var cms=cms||{};cms.components=[];
!function(t,e){function o(t){i=this,this.element=t,this.componentClass=".component",this.initializeComponents(),this.bindEvents()}function n(t){var e=$(t.currentTarget).val();switch($(t.currentTarget).attr("id")){case"view-mode":i.setMode(e);break;case"login-state":i.setState(e)}}t.App=o,t.components=[];var i;o.prototype.constructor=o,o.prototype.currentMode="edit",o.prototype.currentState="loggedin",o.prototype.initializeComponents=function(){var t=this.componentClass;this.pageComponents=$(t).map(this.createComponent)},o.prototype.bindEvents=function(){$("#mode select#view-mode").change(n),$("#mode select#login-state").change(n)},o.prototype.createComponent=function(){var o=$(this).data("component"),n=t.components[o];return o&&n||(n=e),new n(this,i)},o.prototype.setMode=function(t){this.currentMode=t,this.toggleMode(t)},o.prototype.setState=function(t){"preview"==this.currentMode&&(this.currentState=t,this.toggleState(t))},o.prototype.toggleMode=function(t){$(i.element).attr("data-mode",t),$.each(i.pageComponents,function(t,e){e.setMode(i.currentMode)})},o.prototype.toggleState=function(t){$(i.element).attr("data-state",t),$.each(i.pageComponents,function(t,e){e.setState(i.currentState)})}}(cms,cms.Component);
!function(t){function e(t,e){n=this,this.element=$(t),this.app=e,this.initialize()}t.Component=e;var n,o,r;Object.defineProperty(this,"currentMode",{get:function(){return o},set:function(t){o=t,n.toggleMode()}}),Object.defineProperty(this,"currentState",{get:function(){return r},set:function(t){r=t,n.toggleState()}}),e.prototype.isLogged=!1,e.prototype.initialize=function(){this.setMode(this.app.currentMode),this.setState(this.app.currentState),this.bindEvents()},e.prototype.bindEvents=function(){},e.prototype.setMode=function(t){$(this.element).removeClass(currentMode),this.isPreview="preview"==t,currentMode=t},e.prototype.setState=function(t){currentState&&$(this.element).removeClass(currentState),this.isLogged="loggedin"==t,currentState=t},e.prototype.toggleMode=function(){$(this.element).attr("data-currentMode",currentMode),$(this.element).addClass(currentMode),this.onToggleMode()},e.prototype.toggleState=function(){$(this.element).attr("data-currentState",currentState),$(this.element).addClass(currentState),this.onToggleState()},e.prototype.onToggleMode=function(){},e.prototype.onToggleState=function(){}}(cms);
var Person=function(){var t=0,i="John Doe";this.initialize=function(n,e){i=n||i,t=e||t},arguments.length&&this.initialize(),this.getName=function(){return i},this.setName=function(t){i=t},this.getAge=function(){return t},this.addBirthday=function(){t++},this.toString=function(){return"My name is "+this.getName()+"and I am "+t+" years old."}};
!function(t,o){function e(t,o){Object.getPrototypeOf(e.prototype).constructor.call(this,t,o)}t.components.Title=e,e.prototype=Object.create(t.Component.prototype),e.prototype.constructor=e;var i;e.prototype.initialize=function(){this.title=this.element.find("#title-value")[0],this.title_color_input=this.element.find("#color-value")[0],this.logged_color_input=this.element.find("#color-login-value")[0],i=this,o.prototype.initialize.call(this)},e.prototype.bindEvents=function(){$(this.element).find("input").on("keydown",function(t){var o=$(this);13==t.keyCode&&i.setValue(o.val(),o.attr("id"))})},e.prototype.setValue=function(t,o){switch(o){case"color-value":i.setTitleColor(t);break;case"color-login-value":i.setLoggedColor(t)}},e.prototype.onToggleMode=function(){this.title.readOnly=this.isPreview,this.isPreview?this.setState(currentState):this.updateColor(this.title_color||"black")},e.prototype.onToggleState=function(){var t;this.isLogged?(t=this.logged_color||this.title_color,this.updateColor(t)):this.updateColor(this.title_color||"black")},e.prototype.setLoggedColor=function(t){this.logged_color=t},e.prototype.setTitleColor=function(t){this.title_color=t,this.updateColor(t)},e.prototype.updateColor=function(t){$(this.title).css({color:t})}}(window.cms,window.cms.Component);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5hbWVzcGFjZS5qcyIsImFwcC5qcyIsImNvbXBvbmVudC5qcyIsInBlcnNvbi5qcyIsInRpdGxlLmpzIl0sIm5hbWVzIjpbImNtcyIsImNvbXBvbmVudHMiLCJDb21wb25lbnQiLCJBcHAiLCJlbGVtZW50IiwiX3NlbGYiLCJ0aGlzIiwiY29tcG9uZW50Q2xhc3MiLCJpbml0aWFsaXplQ29tcG9uZW50cyIsImJpbmRFdmVudHMiLCJsaXN0ZW5DaGFuZ2UiLCJldiIsInZhbHVlIiwiJCIsImN1cnJlbnRUYXJnZXQiLCJ2YWwiLCJhdHRyIiwic2V0TW9kZSIsInNldFN0YXRlIiwicHJvdG90eXBlIiwiY29uc3RydWN0b3IiLCJjdXJyZW50TW9kZSIsImN1cnJlbnRTdGF0ZSIsIl9jb21wb25lbnRDbGFzcyIsInBhZ2VDb21wb25lbnRzIiwibWFwIiwiY3JlYXRlQ29tcG9uZW50IiwiY2hhbmdlIiwiY29tcG9uZW50TmFtZSIsImRhdGEiLCJjb21wb25lbnRDb25zdHJ1Y3RvciIsInRvZ2dsZU1vZGUiLCJ0b2dnbGVTdGF0ZSIsImVhY2giLCJpbmRleCIsImVsIiwiYXBwIiwiaW5pdGlhbGl6ZSIsIl9jdXJyZW50TW9kZSIsIl9jdXJyZW50U3RhdGUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldCIsInNldCIsImlzTG9nZ2VkIiwibW9kZSIsInJlbW92ZUNsYXNzIiwiaXNQcmV2aWV3Iiwic3RhdGUiLCJhZGRDbGFzcyIsIm9uVG9nZ2xlTW9kZSIsIm9uVG9nZ2xlU3RhdGUiLCJQZXJzb24iLCJfYWdlIiwiX25hbWUiLCJuYW1lIiwiYWdlIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZ2V0TmFtZSIsInNldE5hbWUiLCJnZXRBZ2UiLCJhZGRCaXJ0aGRheSIsInRvU3RyaW5nIiwiVGl0bGUiLCJnZXRQcm90b3R5cGVPZiIsImNhbGwiLCJjcmVhdGUiLCJ0aXRsZSIsImZpbmQiLCJ0aXRsZV9jb2xvcl9pbnB1dCIsImxvZ2dlZF9jb2xvcl9pbnB1dCIsIm9uIiwiZXZlbnQiLCJmaWVsZCIsImtleUNvZGUiLCJzZXRWYWx1ZSIsImlkIiwic2V0VGl0bGVDb2xvciIsInNldExvZ2dlZENvbG9yIiwicmVhZE9ubHkiLCJ1cGRhdGVDb2xvciIsInRpdGxlX2NvbG9yIiwiY29sb3IiLCJsb2dnZWRfY29sb3IiLCJjc3MiLCJ3aW5kb3ciXSwibWFwcGluZ3MiOiJBQUFBLEdBQUlBLEtBQU1BLE9BRVZBLEtBQUlDO0NDRkosU0FBVUQsRUFBS0UsR0FNZCxRQUFTQyxHQUFJQyxHQUNaQyxFQUFRQyxLQUNSQSxLQUFLRixRQUFVQSxFQUNmRSxLQUFLQyxlQUFpQixhQUV0QkQsS0FBS0UsdUJBQ0xGLEtBQUtHLGFBeUNOLFFBQVNDLEdBQWFDLEdBQ3JCLEdBQUlDLEdBQVFDLEVBQUVGLEVBQUdHLGVBQWVDLEtBRWhDLFFBQU9GLEVBQUVGLEVBQUdHLGVBQWVFLEtBQUssT0FDL0IsSUFBSyxZQUNKWCxFQUFNWSxRQUFRTCxFQUNmLE1BQ0EsS0FBSyxjQUNKUCxFQUFNYSxTQUFTTixJQTVEbEJaLEVBQUlHLElBQU1BLEVBQ1ZILEVBQUlDLGFBRUosSUFBSUksRUFXSkYsR0FBSWdCLFVBQVVDLFlBQWNqQixFQUM1QkEsRUFBSWdCLFVBQVVFLFlBQWMsT0FDNUJsQixFQUFJZ0IsVUFBVUcsYUFBZSxXQUU3Qm5CLEVBQUlnQixVQUFVWCxxQkFBdUIsV0FDcEMsR0FBSWUsR0FBa0JqQixLQUFLQyxjQUMzQkQsTUFBS2tCLGVBQWlCWCxFQUFFVSxHQUFpQkUsSUFBSW5CLEtBQUtvQixrQkFJbkR2QixFQUFJZ0IsVUFBVVYsV0FBYSxXQUMxQkksRUFBRSwwQkFBMEJjLE9BQU9qQixHQUNuQ0csRUFBRSw0QkFBNEJjLE9BQU9qQixJQUd0Q1AsRUFBSWdCLFVBQVVPLGdCQUFrQixXQUMvQixHQUFJRSxHQUFnQmYsRUFBRVAsTUFBTXVCLEtBQUssYUFDN0JDLEVBQXVCOUIsRUFBSUMsV0FBVzJCLEVBTTFDLE9BSklBLElBQWtCRSxJQUNyQkEsRUFBdUI1QixHQUdqQixHQUFJNEIs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QyxjQUFnQixXQUMvQixHQUFJZ0MsRUFDRTdFLE1BQUtzQyxVQUNQdUMsRUFBUTdFLEtBQUs4RSxjQUFnQjlFLEtBQUs0RSxZQUNsQzVFLEtBQUsyRSxZQUFZRSxJQUVqQjdFLEtBQUsyRSxZQUFZM0UsS0FBSzRFLGFBQWMsVUFJekNsQixFQUFNN0MsVUFBVTRELGVBQWlCLFNBQVNJLEdBQ3ZDN0UsS0FBSzhFLGFBQWVELEdBR3ZCbkIsRUFBTTdDLFVBQVUyRCxjQUFnQixTQUFTSyxHQUN4QzdFLEtBQUs0RSxZQUFjQyxFQUNuQjdFLEtBQUsyRSxZQUFZRSxJQUdsQm5CLEVBQU03QyxVQUFVOEQsWUFBYyxTQUFTRSxHQUN0Q3RFLEVBQUVQLEtBQUs4RCxPQUFPaUIsS0FBS0YsTUFBU0EsTUFHOUJHLE9BQU90RixJQUFLc0YsT0FBT3RGLElBQUlFIiwiZmlsZSI6InVuaXQtdGVzdGluZy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgY21zID0gY21zIHx8IHt9O1xuXG5jbXMuY29tcG9uZW50cyA9IFtdOyAiLCIoZnVuY3Rpb24oY21zLCBDb21wb25lbnQpe1xuXHRjbXMuQXBwID0gQXBwO1xuXHRjbXMuY29tcG9uZW50cyA9IFtdO1xuXG5cdHZhciBfc2VsZjtcblxuXHRmdW5jdGlvbiBBcHAoZWxlbWVudCl7XG5cdFx0X3NlbGYgPSB0aGlzO1xuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdFx0dGhpcy5jb21wb25lbnRDbGFzcyA9ICcuY29tcG9uZW50JztcblxuXHRcdHRoaXMuaW5pdGlhbGl6ZUNvbXBvbmVudHMoKTtcblx0XHR0aGlzLmJpbmRFdmVudHMoKTtcblx0fVxuXG5cdEFwcC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBBcHA7XG5cdEFwcC5wcm90b3R5cGUuY3VycmVudE1vZGUgPSAnZWRpdCc7XG5cdEFwcC5wcm90b3R5cGUuY3VycmVudFN0YXRlID0gJ2xvZ2dlZGluJztcblxuXHRBcHAucHJvdG90eXBlLmluaXRpYWxpemVDb21wb25lbnRzID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgX2NvbXBvbmVudENsYXNzID0gdGhpcy5jb21wb25lbnRDbGFzcztcblx0XHR0aGlzLnBhZ2VDb21wb25lbnRzID0gJChfY29tcG9uZW50Q2xhc3MpLm1hcCh0aGlzLmNyZWF0ZUNvbXBvbmVudCk7XG5cdH07XG5cblxuXHRBcHAucHJvdG90eXBlLmJpbmRFdmVudHMgPSBmdW5jdGlvbigpe1xuXHRcdCQoJyNtb2RlIHNlbGVjdCN2aWV3LW1vZGUnKS5jaGFuZ2UobGlzdGVuQ2hhbmdlKTtcblx0XHQkKCcjbW9kZSBzZWxlY3QjbG9naW4tc3RhdGUnKS5jaGFuZ2UobGlzdGVuQ2hhbmdlKTtcblx0fVxuXG5cdEFwcC5wcm90b3R5cGUuY3JlYXRlQ29tcG9uZW50ID0gZnVuY3Rpb24oKXtcblx0XHR2YXIgY29tcG9uZW50TmFtZSA9ICQodGhpcykuZGF0YSgnY29tcG9uZW50Jyk7XG5cdFx0dmFyIGNvbXBvbmVudENvbnN0cnVjdG9yID0gY21zLmNvbXBvbmVudHNbY29tcG9uZW50TmFtZV07XG5cblx0XHRpZighY29tcG9uZW50TmFtZSB8fCAhY29tcG9uZW50Q29uc3RydWN0b3IpIHtcblx0XHRcdGNvbXBvbmVudENvbnN0cnVjdG9yID0gQ29tcG9uZW50O1xuXHRcdH1cblxuXHRcdHJldHVybiBuZXcgY29tcG9uZW50Q29uc3RydWN0b3IodGhpcyxfc2VsZik7XG5cdH07XG5cblx0QXBwLnByb3RvdHlwZS5zZXRNb2RlID0gZnVuY3Rpb24odmFsdWUpe1xuXHRcdHRoaXMuY3VycmVudE1vZGUgPSB2YWx1ZTtcblx0XHR0aGlzLnRvZ2dsZU1vZGUodmFsdWUpO1xuXHR9O1xuXG5cdEFwcC5wcm90b3R5cGUuc2V0U3RhdGU9IGZ1bmN0aW9uKHZhbHVlKXtcblx0XHRpZih0aGlzLmN1cnJlbnRNb2RlID09ICdwcmV2aWV3Jyl7XG5cdFx0XHR0aGlzLmN1cnJlbnRTdGF0ZSA9IHZhbHVlO1xuXHRcdFx0dGhpcy50b2dnbGVTdGF0ZSh2YWx1ZSk7XG5cdFx0fVxuXHR9O1xuXG5cdGZ1bmN0aW9uIGxpc3RlbkNoYW5nZShldikge1xuXHRcdHZhciB2YWx1ZSA9ICQoZXYuY3VycmVudFRhcmdldCkudmFsKCk7XG5cblx0XHRzd2l0Y2goJChldi5jdXJyZW50VGFyZ2V0KS5hdHRyKCdpZCcpKXtcblx0XHRcdGNhc2UgJ3ZpZXctbW9kZSc6XG5cdFx0XHRcdF9zZWxmLnNldE1vZGUodmFsdWUpO1xuXHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlICdsb2dpbi1zdGF0ZSc6XG5cdFx0XHRcdF9zZWxmLnNldFN0YXRlKHZhbHVlKTtcblx0XHRcdGJyZWFrO1xuXHRcdH1cblx0fTtcblxuXHRBcHAucHJvdG90eXBlLnRvZ2dsZU1vZGU9IGZ1bmN0aW9uKHZhbHVlKXtcdFx0XG5cdFx0JChfc2VsZi5lbGVtZW50KS5hdHRyKCdkYXRhLW1vZGUnLCB2YWx1ZSk7XG5cblx0XHQkLmVhY2goX3NlbGYucGFnZUNvbXBvbmVudHMsIGZ1bmN0aW9uKGluZGV4LHZhbHVlKXtcblx0XHRcdHZhbHVlLnNldE1vZGUoX3NlbGYuY3VycmVudE1vZGUpO1xuXHRcdH0pO1xuXHR9O1xuXG5cdEFwcC5wcm90b3R5cGUudG9nZ2xlU3RhdGUgPSBmdW5jdGlvbih2YWx1ZSl7XG5cdFx0JChfc2VsZi5lbGVtZW50KS5hdHRyKCdkYXRhLXN0YXRlJywgdmFsdWUpO1xuXG5cdFx0JC5lYWNoKF9zZWxmLnBhZ2VDb21wb25lbnRzLCBmdW5jdGlvbihpbmRleCx2YWx1ZSl7XG5cdFx0XHR2YWx1ZS5zZXRTdGF0ZShfc2VsZi5jdXJyZW50U3RhdGUpO1xuXHRcdH0pO1xuXHR9O1xuXG59KShjbXMsIGNtcy5Db21wb25lbnQpOyIsIihmdW5jdGlvbihjbXMpIHtcbiAgICBcbiAgICBjbXMuQ29tcG9uZW50ID0gQ29tcG9uZW50O1xuICAgIFxuICAgIHZhciBfc2VsZixcbiAgICAgICAgX2N1cnJlbnRNb2RlLFxuICAgICAgICBfY3VycmVudFN0YXRlO1xuXG5cbiAgICBmdW5jdGlvbiBDb21wb25lbnQoZWwsYXBwKSB7IFxuICAgICAgICBfc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuZWxlbWVudCA9ICQoZWwpO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcblxuICAgICAgICB0aGlzLmluaXRpYWxpemUoKTtcbiAgICB9O1xuXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjdXJyZW50TW9kZVwiLCB7IFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge3JldHVybiBfY3VycmVudE1vZGV9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSl7IF9jdXJyZW50TW9kZSA9IHZhbHVlOyBfc2VsZi50b2dnbGVNb2RlKCk7IH0gXG4gICAgfSk7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjdXJyZW50U3RhdGVcIiwgeyBcbiAgICAgICAgZ2V0OiBmdW5jdGlvbigpIHtyZXR1cm4gX2N1cnJlbnRTdGF0ZX0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKHZhbHVlKXsgX2N1cnJlbnRTdGF0ZSA9IHZhbHVlOyBfc2VsZi50b2dnbGVTdGF0ZSgpOyB9IFxuICAgIH0pO1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5pc0xvZ2dlZCA9IGZhbHNlO1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHRoaXMuc2V0TW9kZSh0aGlzLmFwcC5jdXJyZW50TW9kZSk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUodGhpcy5hcHAuY3VycmVudFN0YXRlKTtcbiAgICAgICAgdGhpcy5iaW5kRXZlbnRzKCk7XG4gICAgfTtcblxuICAgIENvbXBvbmVudC5wcm90b3R5cGUuYmluZEV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgfTtcblxuICAgIENvbXBvbmVudC5wcm90b3R5cGUuc2V0TW9kZSA9IGZ1bmN0aW9uKG1vZGUpIHtcbiAgICAgICAgJCh0aGlzLmVsZW1lbnQpLnJlbW92ZUNsYXNzKGN1cnJlbnRNb2RlKTtcbiAgICAgICAgdGhpcy5pc1ByZXZpZXcgPSBtb2RlID09ICdwcmV2aWV3JztcbiAgICAgICAgY3VycmVudE1vZGUgPSBtb2RlO1xuICAgIH07XG5cbiAgICBDb21wb25lbnQucHJvdG90eXBlLnNldFN0YXRlID0gZnVuY3Rpb24oc3RhdGUpIHtcbiAgICAgICAgaWYoY3VycmVudFN0YXRlKXtcbiAgICAgICAgICAgICQodGhpcy5lbGVtZW50KS5yZW1vdmVDbGFzcyhjdXJyZW50U3RhdGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5pc0xvZ2dlZCA9IHN0YXRlID09ICdsb2dnZWRpbic7XG4gICAgICAgIGN1cnJlbnRTdGF0ZT0gc3RhdGU7XG5cbiAgICB9O1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS50b2dnbGVNb2RlID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJCh0aGlzLmVsZW1lbnQpLmF0dHIoJ2RhdGEtY3VycmVudE1vZGUnLCBjdXJyZW50TW9kZSk7XG4gICAgICAgICQodGhpcy5lbGVtZW50KS5hZGRDbGFzcyhjdXJyZW50TW9kZSk7XG4gICAgICAgIHRoaXMub25Ub2dnbGVNb2RlKCk7XG5cbiAgICB9O1xuXG5cbiAgICBDb21wb25lbnQucHJvdG90eXBlLnRvZ2dsZVN0YXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICQodGhpcy5lbGVtZW50KS5hdHRyKCdkYXRhLWN1cnJlbnRTdGF0ZScsIGN1cnJlbnRTdGF0ZSk7XG4gICAgICAgICQodGhpcy5lbGVtZW50KS5hZGRDbGFzcyhjdXJyZW50U3RhdGUpO1xuICAgICAgICB0aGlzLm9uVG9nZ2xlU3RhdGUoKTtcbiAgICB9O1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5vblRvZ2dsZU1vZGUgPSBmdW5jdGlvbigpe1xuICAgICAgICBcbiAgICB9O1xuXG4gICAgQ29tcG9uZW50LnByb3RvdHlwZS5vblRvZ2dsZVN0YXRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgXG4gICAgfTtcblxufSkoY21zKTsgIiwidmFyIFBlcnNvbiA9IGZ1bmN0aW9uKCkgeyBcbiAgICAvL2RlZmF1bHRzXG4gICAgdmFyIF9hZ2UgID0gIDAsXG4gICAgICAgIF9uYW1lID0gJ0pvaG4gRG9lJztcbiBcbiAgICB0aGlzLmluaXRpYWxpemUgPSBmdW5jdGlvbihuYW1lLCBhZ2UpIHtcbiAgICAgIF9uYW1lID0gbmFtZSB8fCBfbmFtZTtcbiAgICAgIF9hZ2UgID0gYWdlICB8fCBfYWdlO1xuICAgIH07XG5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkgdGhpcy5pbml0aWFsaXplKCk7XG4gICAgICBcbiAgICB0aGlzLmdldE5hbWUgPSBmdW5jdGlvbigpeyByZXR1cm4gX25hbWU7IH07XG4gICAgdGhpcy5zZXROYW1lID0gZnVuY3Rpb24gKG5hbWUpeyBfbmFtZSA9IG5hbWU7IH07XG4gICAgdGhpcy5nZXRBZ2UgPSBmdW5jdGlvbigpeyByZXR1cm4gX2FnZX07XG4gXG4gICAgdGhpcy5hZGRCaXJ0aGRheSA9IGZ1bmN0aW9uKCkgICAgICB7IFxuICAgICAgICBfYWdlKys7IFxuICAgIH07XG5cbiAgICB0aGlzLnRvU3RyaW5nICAgID0gZnVuY3Rpb24oKSAgICAgIHsgXG4gICAgICAgIHJldHVybiAnTXkgbmFtZSBpcyAnICsgdGhpcy5nZXROYW1lKCkgKyAnYW5kIEkgYW0gJyArIF9hZ2UgKyAnIHllYXJzIG9sZC4nOyBcbiAgICB9O1xufTsgIiwiKGZ1bmN0aW9uKGNtcywgQ29tcG9uZW50KSB7XG5cbiBcdGNtcy5jb21wb25lbnRzLlRpdGxlID0gVGl0bGU7XG4gICAgXG4gICAgZnVuY3Rpb24gVGl0bGUoZWwsIGFwcCkge1xuICAgIFx0T2JqZWN0LmdldFByb3RvdHlwZU9mKFRpdGxlLnByb3RvdHlwZSkuY29uc3RydWN0b3IuY2FsbCh0aGlzLGVsLGFwcCk7XG4gICAgfTtcblxuICAgIFRpdGxlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoY21zLkNvbXBvbmVudC5wcm90b3R5cGUpO1xuXHRUaXRsZS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUaXRsZTsgICAgXG5cblx0dmFyIHRpdGxlLFxuXHRcdHRpdGxlX2NvbG9yX2lucHV0LFxuXHRcdGxvZ2dlZF9jb2xvcl9pbnB1dCxcblx0XHR0aXRsZV9jb2xvcixcblx0XHRsb2dnZWRfY29sb3IsXG5cdFx0X3NlbGY7XG5cblx0VGl0bGUucHJvdG90eXBlLmluaXRpYWxpemUgPSBmdW5jdGlvbigpIHtcblxuXHRcdHRoaXMudGl0bGUgPSB0aGlzLmVsZW1lbnQuZmluZCgnI3RpdGxlLXZhbHVlJylbMF07XG5cdFx0dGhpcy50aXRsZV9jb2xvcl9pbnB1dCA9IHRoaXMuZWxlbWVudC5maW5kKCcjY29sb3ItdmFsdWUnKVswXTtcblx0XHR0aGlzLmxvZ2dlZF9jb2xvcl9pbnB1dCA9IHRoaXMuZWxlbWVudC5maW5kKCcjY29sb3ItbG9naW4tdmFsdWUnKVswXTtcblxuXHRcdF9zZWxmID0gdGhpcztcblxuXHRcdENvbXBvbmVudC5wcm90b3R5cGUuaW5pdGlhbGl6ZS5jYWxsKHRoaXMpO1xuXHR9O1xuXG5cdFRpdGxlLnByb3RvdHlwZS5iaW5kRXZlbnRzID0gZnVuY3Rpb24oKXtcblxuXHRcdCQodGhpcy5lbGVtZW50KS5maW5kKCdpbnB1dCcpLm9uKCdrZXlkb3duJywgZnVuY3Rpb24oZXZlbnQpe1xuXHRcdFx0dmFyIGZpZWxkID0gJCh0aGlzKTtcblxuXHRcdFx0aWYoZXZlbnQua2V5Q29kZSA9PSAxMykge1xuXHRcdFx0XHRfc2VsZi5zZXRWYWx1ZShmaWVsZC52YWwoKSwgZmllbGQuYXR0cignaWQnKSk7ICAgIFxuICAgIFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0VGl0bGUucHJvdG90eXBlLnNldFZhbHVlID0gZnVuY3Rpb24odmFsdWUsIGlkKXtcblx0XHRzd2l0Y2goaWQpe1xuXHRcdFx0Y2FzZSAnY29sb3ItdmFsdWUnOlxuXHRcdFx0XHRfc2VsZi5zZXRUaXRsZUNvbG9yKHZhbHVlKTtcblx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnY29sb3ItbG9naW4tdmFsdWUnOlxuXHRcdFx0XHRfc2VsZi5zZXRMb2dnZWRDb2xvcih2YWx1ZSk7XG5cdFx0XHRicmVhaztcblx0XHR9XG5cdH07XG5cblx0VGl0bGUucHJvdG90eXBlLm9uVG9nZ2xlTW9kZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMudGl0bGUucmVhZE9ubHkgPSB0aGlzLmlzUHJldmlldzsgIFxuXG4gICAgICAgIGlmKHRoaXMuaXNQcmV2aWV3KXtcbiAgICAgICAgXHR0aGlzLnNldFN0YXRlKGN1cnJlbnRTdGF0ZSk7ICAgICAgICBcdFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICBcdHRoaXMudXBkYXRlQ29sb3IodGhpcy50aXRsZV9jb2xvciB8fCdibGFjaycpO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgVGl0bGUucHJvdG90eXBlLm9uVG9nZ2xlU3RhdGUgPSBmdW5jdGlvbigpe1xuICAgIFx0dmFyIGNvbG9yO1xuICAgICAgICBpZih0aGlzLmlzTG9nZ2VkKXtcbiAgICAgICAgXHRjb2xvciA9IHRoaXMubG9nZ2VkX2NvbG9yIHx8IHRoaXMudGl0bGVfY29sb3I7XG4gICAgICAgIFx0dGhpcy51cGRhdGVDb2xvcihjb2xvcik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgIFx0dGhpcy51cGRhdGVDb2xvcih0aGlzLnRpdGxlX2NvbG9yIHx8J2JsYWNrJyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgVGl0bGUucHJvdG90eXBlLnNldExvZ2dlZENvbG9yID0gZnVuY3Rpb24oY29sb3Ipe1xuICAgICAgXHR0aGlzLmxvZ2dlZF9jb2xvciA9IGNvbG9yO1xuICAgIH07XG5cbiAgICBUaXRsZS5wcm90b3R5cGUuc2V0VGl0bGVDb2xvciA9IGZ1bmN0aW9uKGNvbG9yKXtcbiAgICBcdHRoaXMudGl0bGVfY29sb3IgPSBjb2xvcjtcbiAgICBcdHRoaXMudXBkYXRlQ29sb3IoY29sb3IpOyAgXG4gICAgfTtcblxuICAgIFRpdGxlLnByb3RvdHlwZS51cGRhdGVDb2xvciA9IGZ1bmN0aW9uKGNvbG9yKXtcbiAgICBcdCQodGhpcy50aXRsZSkuY3NzKHsnY29sb3InOiBjb2xvcn0pO1xuICAgIH07XG5cbn0pKHdpbmRvdy5jbXMsIHdpbmRvdy5jbXMuQ29tcG9uZW50KTsiXX0=
